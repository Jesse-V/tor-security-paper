\documentclass[journal]{IEEEtran}
\usepackage{graphicx}
\usepackage{amssymb,amsmath}

\begin{document}

\title{The Tor Network - Strengths and Weaknesses \\ \Large Computer Security 1 - CS5460 \\ \LaTeX{}}
\author{Jesse Victors}

\maketitle

\section{Introduction}

The Tor network is a second-generation onion routing system that aims to provide anonymity, privacy, and Internet censorship protection to its users. Tor routes TCP traffic through a worldwide and volunteer network of over four thousand relays. Its encryption, authentication, and routing protocols are designed to make it exceptionally difficult for an adversary to identify an end user or reveal their traffic.

\section{Design}

Tor provides an anonymity and privacy layer by relaying all end-user TCP traffic through a series of \textit{relays} on the Tor network. Typically this route consists of a carefully-constructed three-hop path known as a \textit{circuit}, which changes over time. These nodes in the circuit are referred to as \textit{entry guard}, \textit{middle router}, and the \textit{exit node}, respectively. Only the first node can determine the origin of TCP traffic through Tor, and only the exit node can examine the contents and its destination. Nodes in the middle are unable to determine either. No single node can determine the origin, the contents, and the destination of traffic through the network. Tor's architecture is designed to make it exceptionally difficult for a well-resourced adversary to uncover the identity of the end-user and their network activities, even if nodes are compromised.\cite{McCoy2008}

\subsection{Routing}

Routing information is distributed by a set of authoritative directory servers.\cite{McCoy2008}

Tor achieves anonymity by routing a user's traffic through a circuit of several random relays, wherein each relay is only capable of decrypting the address of the next relay in line. Hence, even compromised relays will be unable to deduce what the traffic is or where they came from, and an outsider is faced with multiple layers of public-key -- either RSA or elliptic curve -- encryption on top of TLS protocols. Currently, Tor is one of the most secure tools to use against network surveillance, traffic analysis, and to bypassing information censorship.

\subsection{Encryption}

Encryption is a necessary component for privacy within the Tor network. Traffic passing between nodes must be secured from outsiders, and even compromised nodes must not be able to observe the traffic in cleartext. Privacy is also important for traffic outside the network; encrypted connections between the exit node and the target web server must also be achieved. Furthermore, two layers are needed: one for inside the network and one for outside it.

Within the network, nodes talk to each other via the Transport Security Layer (TLS) protocol. When a circuit is built, each pair of nodes within it must first come to an agreement over an encryption key and the specific cipher to use for encryption. There are several mechanisms by which this can be done, all of which use Diffie-Hellman (DH) for key exchange. The most common methods include: TLS_RSA, which rely upon public and private keys generated with RSA; TLS_DHE, ephemeral DH; TLS_ECDH, DH based on elliptic curves, and TLS_ECDHE, ephemeral elliptic curve DH. It should be noted that only TLS_DHE and TLS_ECDHE provide perfect forward secrecy, so it is no surprise that Tor exclusively prefers them. Once encryption keys and the specific cipher (as well as its mode) have been agreed upon, communication of traffic between two nodes can be encrypted and exchanged.

Tor users typically use the Tor Browser Bundle, (TBB) a custom build of Mozilla Firefox with a focus on security and pricacy. The TBB not only provides special handling of client-side scripts such as Javascript, but also offers the HTTPS Everywhere extension, which uses regular expressions to rewrite web requests into ones that use HTTPS. Thus, if the web server is capable of handling SSL or TLS connections, HTTP communications will be encrypted under them. Like any typical browser, the TBB negotiates with the web server for the cipher and keys required for SSL/TSL, except that this negotiation entirely occurs through the Tor circuit. As previously noted, this information, along with subsequent HTTP data, is encrypted between each node in the circuit. During transmission, each node in the circuit decrypts its layer in turn, until the final node (the exit) passes the data to the target server. The TLS/IP connections remain open, so the returned information likewise travels back up the circuit to the end user.

In September 2013, Robert Graham of Errata Security analyzed 22,920 incoming connections to his exit node and found that 89.9\; of the circuits agreed to use the Advanced Encryption Standard (AES) block cipher in cipher-block chaining (CBC) mode. This is the most common mode for AES, and allows for parallel decryption of the data blocks. The other 10.1\; of the circuits relied upon the Data Encryption Standard (DES) cipher for encryption. Furthermore, 75.7\% of the circuits used elliptic-curve DH, with the remaining 22.3\% relying upon traditional RSA DH.\cite{Graham2013} Both protocols are discussed below.

\subsubsection{RSA}
%http://security.stackexchange.com/questions/8343/what-key-exchange-mechanism-should-be-used-in-tls
%https://en.wikipedia.org/wiki/Comparison_of_TLS_implementations
%https://www.ipa.go.jp/security/rfc/RFC5246-ACJA.html

RSA...
The security of the first is based on the difficulty of factoring the product of two large primes

\subsubsection{Elliptic-curve}

Elliptic Curve Cryptography (ECC) is an approach to public-key cryptography in which elliptic curves are used instead of RSA. In contrast to RSA, ECC relies upon the infeasiblity of finding the discrete logarithm of a random elliptic curve element with respect to a publicly known base point. This is known as the elliptic curve discrete logarithm problem, or ECDLP.

Elliptic curves over the real number system can be defined through the equation,
y^2\; =\; x^3\; +\; a x\; +\; b\;
Where \textit{a} and \textit{b} are real numbers. This formula describes a plane curve through the Euclidean plane, although elliptic curves do exists in other spaces. However, current cryptographic purposes only work with elliptic curves within the context of the real number systems.

A smaller key size is one of the most significant benefits introduced by ECC. Current NIST recommendations state that a key size of 160 bits for ECC offers a similar level of security to 1024 bits of RSA/DH. Likewise, 224 bits for ECC is analogous to 2048 bits of RSA/DH. It should be noted that the required key sizes for ECC increases significantly slower than the key sizes for RSA and Diffie-Hellman increase at a much faster rate than the required key size for ECC. Thus ECC offers more security per increase in key size than for RSA. The smaller key size also directly correlates to an increase in computational efficiency; as the bit size increases, the speed difference between Diffie-Hellman and ECC grows superlinearly.\cite{CaseForECC}

Tor 2.4.x introduced ECC into its DH key exchange protocols, known as \textit{NTor}.

\subsection{Authentication}

Authentication...

\section{Adversaries}

It was recently revealed that the National Security Administration (NSA) has been targeting Tor, albeit with marginal success in breaking the anonymity and privacy of its users. However, in early October, the FBI successfully identified and arrested the owner of the Silk Road, a black market operating as a hidden service within the Tor network, and seized the service.

\section{Challenges}

TBB - javascript and cross-scripting

To achieve its low-latency objective, Tor does not explicitly re-order or delay packets within the network.\cite{McCoy2008}

% https://en.wikibooks.org/wiki/LaTeX/Bibliography_Management
\begin{thebibliography}{9}

% http://homes.cs.washington.edu/~yoshi/papers/Tor/PETS2008_37.pdf
\bibitem{McCoy2008}
  Damon McCoy, Kevin Bauer, Dirk Grunwald, Tadayoshi Kohno, Douglas Sicker,
  \emph{\LaTeX: Shining Light in Dark Places: Understanding the Tor Network}.
  Department of Computer Science and Engineering,
  University of Washington, Seattle, WA 98195-2969,
  2008.

% http://delivery.acm.org/10.1145/1320000/1314336/p11-bauer.pdf?ip=129.123.212.2&id=1314336&acc=ACTIVE%20SERVICE&key=C2716FEBFA981EF14CED21A2601DAAECFD63F9AFA4F38248&CFID=375634674&CFTOKEN=21383502&__acm__=1383519744_1cd525050cafbe9ffe083b269ff783d9
\bibitem{Bauer2007}
  Kevin Bauer, Damon McCoy, Dirk Grunwald, Tadayoshi Kohno, Douglas Sicker
  \emph{\LaTeX: Low-resource routing attacks against tor}.
  ACM, 2007

% http://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=5636000&tag=1
\bibitem{Chaabane2007}
  Abdelberi Chaabane, Pere Manils, Mohamed Ali Kaafar
  \emph{\LaTeX: Digging into Anonymous TrafÔ¨Åc: a deep analysis of the Tor anonymizing network}.
  IEEE, 2010

% https://www.torproject.org/docs/faq.html.en
\bibitem{TorFAQ}
  Tor FAQ

% http://www.nsa.gov/business/programs/elliptic_curve.shtml
\bibitem{CaseForECC}
  National Security Agency
  \emph{\LaTeX: The Case for Elliptic Curve Cryptography}.
  NSA, 2009

% http://blog.erratasec.com/2013/09/tor-is-still-dhe-1024-nsa-crackable.html
\bibitem{Graham2013}
  Robert Graham
  \emph{\LaTeX: Tor is still DHE 1024 (NSA crackable)}.
  Errata Security, 2013

\end{thebibliography}

\end{document}
